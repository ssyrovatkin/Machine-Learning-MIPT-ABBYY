# SciDevNN-Framework
Вашему вниманию предлагается задание, в котором вам предстоит реализовать базовые, сверточные и рекуррентные слои, необходимые служебные функции для их совместной работы, а также функциональные тесты и тестовое приложение. Интерфейс и некоторые тесты уже написаны за вас.

## Система оценивания
Будет уточнена в материалах курса. 

Всего баллов: 30.

## Реализация SciDevNN

Предполагается, что ваш фреймворк должен полностью должен повторять аналогичный функционал PyTorch.
Для реализации разрешено использовать тензоры PyTorch (torch.Tensor) и только базовые операции над ними (сложение, умножение, slicing, exp, sin и т.д.). Запрещено использовать autograd в каком-либо виде и готовые слои, в т.ч. их функциональное api. 

Для большей части модулей были реализованы тесты с использованием pytest. Они лежат в папке tests. Оценка будет базироваться на количестве пройденных тестов.
При реализации можно (и нужно) использовать ранее написанный код (напр. линейные слои).

### Базовая часть
Эта часть является обязательной. Полное её отсутствие сделает невозможным сдачу всего задания!

*Тесты: test_basic.py*   
Реализовать прямой-обратный проходы (и желательно прочий функционал для 
дальнейшего использования в модели) для следующих модулей:
* Линейный слой (полносвязный)
* Активации:
  * Softmax
  * Sigmoid
* Функции потерь:
  * MSELoss
  * CrossEntropyLoss
* Оптимизаторы:
  * SGD (самый простой)
  * Adam 
  
### CNN 

*Тесты: test_conv.py* -- **только Conv2D и BatchNorm**  
Реализовать прямой-обратный проходы (и желательно прочий функционал для 
дальнейшего использования в модели) для следующих модулей:
* Conv2D
* BatchNorm
* ReLU
* MaxPooling -- реализовать полностью, самостоятельно сделать тест в test_conv.py для прямого-обратного проходов.

### RNN

**Для данной части предполагается самостоятельная реализация тестов, аналогично
тому, как это сделано для остальных модулей.**    
*Файл для тестов: test_rnn.py*    
Требуемые модули:
* Ячейки рекуррентной сети (обрабатывает 1 элемент последовательности):
  * RNNCell
  * LSTMCell
* Активация: Tanh

#### Требования к тестам
Тесты должны тестировать прямой и обратный проход для рекуррентных ячеек и гиперболического тангенса. 
При этом, предполагается, что тесты будут запускаться на последовательностях **различной** длины,
т.е. от 1 до скольки хотите.

## Использование SciDevNN

Данная часть предполагает использование модулей из SciDevNN в бою. Реализованные модули следует соединить в нейронную сеть, состоящую из нескольких реализованных вами слоев. Обученную сеть надо уметь сериализовать после обучения и десереализовать для применения (inference).

### main.py
Точка входа в вашу модель. В зависимости от аргументов командной строки должна уметь либо обучать модель и сохранять ее веса, либо подгружать уже сохраненную и прогонять ее на данных.

### data

*data/my_data.py* - ваш датасет для тестирования. Для проверки линейных и сверточных слоёв рекомендуется взять MNIST

### model

Сюда можно положить одну или несколько моделей, на которых вы будете демонстрировать работу фреймворка.

### Вспомогательный функционал

#### util
* *train.py* 
  * train_model - функция, которая умеет обучать модель (создавать базовый вариант модели, 
  оптимизаторы, функции потерь, подгружать набор данных)
  * save_model - функция, которая сохраняет веса обученной модели 
* *inference.py*:
  * infer_model - функция, которая умеет запускать прямой проход модели
  * load_model - функция, которая подгружает веса обученной модели

Формат и алгоритм сериализации предполагается разработать непосредственно студентам.


## Требования к коду
Соблюдать pep8, проходить проверки mypy (аннотации типов). В задании используется Python 3.9 и torch 1.10.
